language: objective-c
osx_image: xcode7
env:
  global:
  - KIF_SCREENSHOTS=$PWD/Screens
  - secure: 7Lt+FXRE+b4iO/49CdxmKaTTVJpq3nhJBG5fzmTmVnRY4oUCcd2dfWlBDD9Zyt87g5OSkcmJGQTWbvkU05ohbCJzMzdtPJ5Pgbkuet77vHbRXBN8RM/AKgPOo3A56r4rGgwFVaR8oUr6BElz3/fmfdN9D0BXL4Brf0PUODgpron1n37UiQ4P4komRdY/2TjVWfKz9owphFHKSR3ux0iAuBClSCa/rB38m5C0G8EVMVTVT+/IL0WiyTyax0nTVJjZ47yMTEdHO4KoEEAY+nxiC/IOlo9BZQH2l9cjho4Zhfn8+NM2Pxm4fwJntgz1bsPsroI1i/9LFcn4Osmq1JazBJ4xQbO6iqOj2guYYqBqqzvSoprk0xCJEFEY62mlDMm7xLYkHP4v72+ffvZ4kkE2rgkp8bre17wfrSDlqMBQGascs5lL0KGIxu9LmTTEXng0RUcDYuh3mqssh+W/SIIvyqcIe2iltNgQf4MjIhUD516G9d7FbWp26zmrZiGyB4RjZhfrkx3QQAVaFk21bddQLWpuUJIk6VJZc8CPDCBaixmD8nvP9EeZ8pBXY+mKCZ4g9MJOkk12PpRYzbPcYpG/z/uRrkKEuTqe+jZMDJWXGlxMjDrsvRrzBjoMMMDRuKmhg5+KJ8zhyjYslYcO5MCgVQnATj3a/zEevPY3YPPPIt8=
  - secure: 0Vkj6w05bgMSOsEnXWFJOBbd/UBKDFWk27q7WbSasX51vulRZe82BjKK6PZICjkGy+6S1BYVVHSRfVQ9VPWW1u8jt9plcsGiGpyOn97uzpD2GUJTmhAc7o+b2HIRzvDjExVB/KPq+Xw2AWlT0JNwUVVoy8myABRW8Tr7eVmDameOfl1WjRKc0iwYolqcZT95p4Vr78T94xhZnVZxzY387+WqDAlpTHgMb9tKkmtvfigZPpXYrfrGEKPYdIGIqpJAgb6PtMSXelBFYCvB1ZLk34gs1VdUCqUaBHArPNAaITdswtrMn6C7ILNCvcFdw64dbFZ4QfGTNcKGED+UuN3cAf15ulXXnhXnUvyjhPkryzZXKyJDbfrNcK17F1oca/dHzyx5eoiDI4cTwgYVW2hQFMsM0yBwq7iEu1Rp/EfgJiF/L8CQPfHUUYz/q1L5QJXOxOU2E7eIL30Mek1FHnOpoeL/pKkdPAnG33fi35rsebJ5hxFCsYg1r0j8GMScRmBPUhzEfgMAa52pJONoWLCVaHWvUDO7uzqAbPuUl+33QSwFjhh29o3wd8p7Mgfk+zHitau7LezshFvGKZTxeV3V47RWu8GP9ywJz6e36waZTQQto5n4+E/p7Jl8mUOmtxYQTPSZu5MYufBqDRw3GOeO7Rv9q+b9z7DIYKJ/KPN4lu4=
  - secure: i/KI14CwIouiBaVizEQEfkN5S10/i/78qY4RNBxReYWGqCqYcbaId9ksjHmrQMzRiB+k/vKGHdgQXnUDgZ3Ja5Mf35snScvvMcsnZUnupyerCpq3emfY5Yjb45ZCkkmNMhp53X6Nl8ZaqvpJ22VABX9G+MIGq0KBdm2A3A4j7rqajrukDyIW2yhma0skH4D7gYlEb+wc1zcGXG16Xi2kcEm5XOnJTvgFZFWbmk4U/+LknizghwUWNJkN44ZelHQWnnY1IKo54JKCtK/DJCTAslcRvbeSRl7tOXhmuD6eFhD2ll80r4KkyLCpTtRIgBWK4nqm2YdxwJLTZOsBb91tTN1ka/vfFse6qHkjzdzsu557CD4juPnVZXmvmzqeglUYIWuRrnmrW2qwARwYV9KTvuYJR01KLqTwfB73IKe8gKn9C2CL7u3z9MKxICcwq0BodG7PGJ6FhbqiaoFPDRu7MrF3L4F/5o/r35pkwHcbCF/dSvRRGCnDPqUytI0wtpjKquLnTTk8lrKW2CfYScnUnqw2MGa0PmELELSOEy3e+BuV5I5kOqSTjyFptHOhDwYfn5vM2KnlR5BfGUpbVabcA+4MYrzMNzrOCGxBDz3wkaOMP4bG3K0oo73RUOTttDkc6RzYYDMEiZzYCspRi+NvLpEkoGRrzi+lUUin88W8ipM=
  - secure: Nl+yR9zSAfzxwvgLd4NwbHU3KxopFzzjK42/i7KdJYSuqliGsg76CzKlsY9zc4Hq4mVnhUUt1+tu1c02uZ93snPBChpWkfuRyHG+fQ0SUWK0VAO2XYHIdXbPi60JeFi4KiHhI/yMIKCYTPHQh78VnLpgqX9HP6XlJ1hIROwABrq9PQqezO1esaquXJRu5SEAydAYPRMQ3lZaguoAYeZBtibjqKbBqc96ZPrWnLfoDw3crdBKJ3PGpO5INcypGEwihUkD5OJqMZ7r7Dk21sBHLFY5u0xxEC9rFOik/x6Z/1ziOrb5ykFea3tvsRuIhSp2GiMZuZjMuehoFpA5uaAWiZjYJhcNE2MoirDp2jO606zRnUior7W0mqaR42wOckNfGmS1cewE5mSWk7xlvbqL6WvHLxhAbTFY8ID69fFU4r1JoMoQP03C717D8IQ7I2YAp87Oi2IuuWHtV1J691IXwfMpCDJFN/3eopzwW3wC/AvcLusXxBGIyWY26ZEHTVQr/LRh+sIO92lr6TrT+7QCdDkCu7agUQhdMK+w4kIpsdHJvsFhFoSuPrlsRmhXCpmG9RQCuybBsGf/19BOqTkbgiBI+JflpUTlmCBHTMYD7cWPJq7B/Mm5dx+8TPNmSIn3ANYhJpNFsEI0U1DRdN1bYKj1WX4nJj3t9QJt5WZb2fo=
  - secure: c/8peUvGrUScKhXgik9qUv13QGoV5vdGpY7p+HLxotmdSHq8ScjNK+g0snqkqd7j/uJd5nbh+cl92KsO3kQNKgI3TNFcxHcbygqFcEmuHNLyDMSj3N8rVpgrwxd5fFrVVdXzFeNN2DjoDVpt9hPvc9JZgIpyPUGjUrwgp7glGnPifiLP0WAe9WscgIW8koUhG31BuaIfCrAWVCTl7qHGbNlBOm+GM6A+PNgYziJmv3pwyy4rtgAbNuc+qqJ78q57BLJfCYtbN8OUasjVLfbsU3KgJ9fFRRmAKhEaeMXDja+76tCpho3rfD0m/x47LwhG5+AGNrcEwGzgKoa+/p0iZVrd89INuJ5ok5BDkeB59wK/h+mA8UTUnHRJl5rASzlrUvmzpnSqcDN0iplJbIZOuys1lobEnwq0F8fjmyngC2YYY9umIoOO5whfKCtlFRgddjKChhlX935CGonuocdA+8Ml3EnTIgbMsbUY/xNSkmIhYvpsfE9ud75/sQPWiR4pyWwXUYkrvhPvUlVq693z2wr0GKE8e42moPz/WKNaMsr7XNsDvSXY1BbStqlz4U6uuXyv24pyBFs+4FaIjOtlP1BZTTTxnek4mvCAAAhTPbbItiuCjW1+aCGdnNFXE4d1gpe8IDkK8yCbJf4MdnqwPAud7TBPWHk6+9WWNq3MKcc=
  - secure: BXwevD8vKHPxLpJ96p63/reP9v1Y3Oz2aMw/Xt2oBmlJxKOACzVkD6RpUEh7vk0H4fZYChssUUhgJnwkSK3EZ+aa5nO4C46tbO9Vk4SXEUvKPQ4xol5uWWfFiN/4v1KsnF9GbjSFivRBOR9vx9FFGk7R7NpSDIy7lRGJkKl6JQz2R6EsXGUyp0didS94EymIiqGM3nuybxCVPekTS86QA8Q3Nt/sR1XwO2rgfrPPkIHTphGmNoIho8sC78/T75kEpDVrjZ3LJxBKv4r28tci0uk9BDOsJs99iXgLLtUBYAHtz6Rgaqzb09t1gxhmK22WhnwRxquMroZTAGoXfC/nM2wqzUdslIrn6CT3Z12YilnpRmOsrF7yRtbr7daNXzF6/GPkwZeYOk+ptBX0q//wR3ybsIH5Eb9RumzbjJYcKQHTE0vxd4GnKIAPakX+MpTM/Myw8L4SeVuAS4h4dIf9AH7xLbUdYI4Ml/vcPgsjw+p6vMcbjhm2fMy0FKKUiIMyV5swuersAlmpPoc5dKutwz/BTWKGua+JjFOqTb9/fniLRakXL7dk9eBhN4547BEMkqea3jAzuYdMvLLa3O5I9MmLfGDOY+ObrlFaVV/69jyDSSI58Ze3DiDJJ0xoacaCGQKWlC7sd09aNNmWHQXBCqmiFCHEHF9QmXyj87zbJhU=
before_install:
- brew update 1>/dev/null
- brew install doxygen nasm yasm optipng imagemagick coreutils intltool ninja antlr
  cmake
- wget --no-check-certificate https://raw.github.com/yuvi/gas-preprocessor/master/gas-preprocessor.pl
- chmod +x gas-preprocessor.pl
- sudo mv gas-preprocessor.pl /usr/local/bin
- sudo ln -s /usr/local/bin/glibtoolize /usr/local/bin/libtoolize
- sudo mkdir -p /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/
- sudo ln -s /usr/bin/strings /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/strings
- sudo mkdir -p /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/
- sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/libxml2.tbd
  /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/libxml2.dylib
  || true
- sudo mkdir -p /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/
- sudo ln -s /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/libsqlite3.tbd
  /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk/usr/lib/libsqlite3.dylib
  || true
- git submodule update --init --recursive
- bundle install
install:
- "./prepare.py -d all -G Ninja -DENABLE_WEBRTC_AEC=ON -DENABLE_H263=YES -DENABLE_FFMPEG=YES
  --enable-non-free-codecs --enable-gpl-third-parties"
- "./Tools/travis_script.sh"
script:
- xcodebuild -project linphone.xcodeproj -scheme linphone -sdk iphoneos -configuration
  Debug build CODE_SIGNING_REQUIRED=NO CODE_SIGN_IDENTITY="" CODE_SIGN_ENTITLEMENTS=""
  1>/dev/null
after_success:
- "./Tools/release.sh"
notifications:
  flowdock:
    secure: XulX1WBdwcW09KFJOfPgRNzb08jGavzPPfpj9slg5Xk9Ib83cduJo04wVanbA92xVBsgLPNPvuu441LFqNRn3w6xbVDA75JyTmT1ih+W8VaaBZLfovrAbmpBEpXk3VUqn7UID+Hl/rkfYO+9fw+qPzJnomRMZ04ldc8hUfHH3ImfO3B8dMt1IMSaoy88A7f4/Vm4EGXWDDY35ZJxO560w5Rr9QgiALllpHdgxHDScJK73RceDi75gUfvNIZqW7c/AQI7dJ6QbQ15Esw2i/x5eHIGMYCheXPiazW6/3GONrz5cmcZ7ecEDPLMVvzKS38DN5iAFwZ5kFixS/h30WhcVsT6ZWPcDWHyJGNWGRqpwJn/IROCb+0f6Y2BtZ4ReDEq5nHPviZvN4eTi9uvWs8jE+8wh2DpJ9VfAu8UADouzxfK7W/A5YgcQA+6Q98anlAICfwCsobcS72MWa4MoUFscKlxe8byqL+ZZWxoEGq79s6OIMuVtTqpNEaLCDflHUAv9q+hDXXyTHMGhrCplQ7b8yfv7JAmmareqnz6V+FsGj3gd6sbLK+W9TQ8y8wnJAX6ZZvfIIPbqzKHc12I5Y0jJmkTLfrrMfE5kQ8uK9GquAvMsjySNYO6+0ljcLi09+yo40gi+tcRXTYtjhjqr8O5Qj0N0I+39xF/TPiaMXKqBmk=
